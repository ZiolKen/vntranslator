<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta content="ie=edge" http-equiv="X-UA-Compatible" />
  <meta name="theme-color" content="#0b0b10" />

  <title>Ren'Py Dialog Extractor & Merger | VN Translator</title>

  <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;800&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />

  <link rel="stylesheet" href="extractor.css" />

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-BXTNE3VPWH"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-BXTNE3VPWH');
  </script>
</head>

<body>
  <div class="bg" aria-hidden="true">
    <div id="particles-js"></div>
    <div class="grid-bg"></div>
    <div class="glow"></div>
  </div>

  <header class="topbar">
    <a class="brand" href="./">
      <span aria-hidden="true">
        <img class="brand__img" src="https://files.catbox.moe/2x5vw3.jpeg" alt="VN Translator" />
      </span>
      <span class="brand__text">
        <span class="brand__name">VN Translator</span>
        <span class="brand__tag">Renâ€™Py â€¢ RPG Maker â€¢ Text Tools</span>
      </span>
    </a>

    <nav class="nav">
      <a class="nav__link" href="./renpy/">Renâ€™Py</a>
      <a class="nav__link" href="./rpgm/">RPG Maker</a>
      <a class="nav__link" href="./game-text-editor/">Game Text Editor</a>
      <a class="nav__link nav__link--active" href="#">RPY Extractor</a>
    </nav>

    <div class="topbar__actions">
      <a class="pill pill--primary" href="./renpy/">Back</a>
    </div>
  </header>

  <main class="wrap">
    <section class="pageHead">
      <div class="pageHead__left">
        <div class="badge">
          <span class="dot" aria-hidden="true"></span>
          Renâ€™Py Utility
        </div>

        <h1 class="title">
          Extract & merge <span class="accent">RPY dialogs</span>
        </h1>

        <p class="subtitle">
          Export dialogues from .rpy for translation, then merge translated text back into the original file safely.
        </p>

        <div class="quickActions">
          <a class="btn btn--ghost" href="./renpy/">ğŸ® Renâ€™Py Translator</a>
          <a class="btn btn--ghost" href="./">ğŸ  Home</a>
        </div>
      </div>

      <div class="pageHead__right">
        <div class="miniPanel">
          <div class="miniPanel__row">
            <div class="miniPanel__k">Recommended</div>
            <div class="miniPanel__v"><span class="chip chip--ok">Translate with DeepSeek</span></div>
          </div>
          <div class="miniPanel__row">
            <div class="miniPanel__k">Beta note</div>
            <div class="miniPanel__v">Complex scripts may need manual review</div>
          </div>
          <div class="miniPanel__row">
            <div class="miniPanel__k">Safety</div>
            <div class="miniPanel__v">Always keep backups</div>
          </div>
        </div>
      </div>
    </section>

    <section class="layout">
      <div class="col">
        <section class="panel" id="extractCard">
          <div class="panel__header">
            <div>
              <div class="panel__title">Extract Dialog</div>
              <div class="panel__hint">Select one or multiple .rpy files</div>
            </div>
          </div>

          <div class="panel__body">
            <input type="file" id="extractFile" accept=".rpy" multiple />
            <button id="extractBtn" class="btn btn--primary btn--block" style="margin-top:12px;">â–¶ï¸ Extract Dialog</button>
          </div>
        </section>

        <section class="panel" id="mergeCard">
          <div class="panel__header">
            <div>
              <div class="panel__title">Merge RPY</div>
              <div class="panel__hint">Pick translated + original, then combine</div>
            </div>
          </div>

          <div class="panel__body">
            <label>ğŸ“‚ Select Translated RPY</label>
            <input type="file" id="translatedFile" accept=".rpy" />

            <div class="spacer"></div>

            <label>ğŸ“‚ Select Original RPY</label>
            <input type="file" id="originalFile" accept=".rpy" />

            <button id="mergeBtn" class="btn btn--ok btn--block" style="margin-top:12px;">ğŸ”€ Combine RPY</button>
          </div>
        </section>

        <section class="panel">
          <div class="panel__header">
            <div>
              <div class="panel__title">Notice</div>
              <div class="panel__hint">Known limitations & tips</div>
            </div>
          </div>

          <div class="panel__body notice">
            <ul class="notice-list">
              <li>ğŸ§© This tool is still in <b>Beta</b>.</li>
              <li>âš™ï¸ Complex RPY may require re-checking extracted text.</li>
              <li>ğŸ›  Works best with standard Renâ€™Py projects.</li>
              <li>ğŸ” Merge requires <b>Translated RPY</b> + <b>Original RPY</b>.</li>
              <li>ğŸ”„ To translate extracted text, use <a href="./renpy/" target="_blank" rel="noopener">Renâ€™Py Translator</a>.</li>
              <li>âš ï¸ Use at your own risk â€” always backup first.</li>
            </ul>
          </div>
        </section>

        <div class="backRow">
          <a href="./renpy/" class="backBtn">â¬…ï¸ Back to Renâ€™Py Translator</a>
        </div>

        <div class="footer-note">
          âš ï¸ By using this tool, you agree to accept all kinds of risks.
        </div>
      </div>

      <div class="col">
        <section class="panel panel--log">
          <div class="panel__header">
            <div>
              <div class="panel__title">Conversion Log</div>
              <div class="panel__hint">Status & output messages</div>
            </div>
          </div>

          <div class="panel__body">
            <div id="log" class="log-container">[SYSTEM_BOOT] :: Awaiting input...<br></div>
          </div>
        </section>
      </div>
    </section>
  </main>

  <script>
    const isMobile = /Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    const particleCount = isMobile ? 60 : 111;

    particlesJS("particles-js", {
      "particles": {
        "number": { "value": particleCount, "density": { "enable": true, "value_area": 950 } },
        "color": { "value": "#a855f7" },
        "shape": { "type": "circle", "stroke": { "width": 0, "color": "#000" } },
        "opacity": { "value": 0.40, "random": true, "anim": { "enable": false } },
        "size": { "value": 2.2, "random": true, "anim": { "enable": false } },
        "line_linked": { "enable": true, "distance": 160, "color": "#a855f7", "opacity": 0.16, "width": 1 },
        "move": { "enable": true, "speed": 0.75, "direction": "none", "random": false, "straight": false, "out_mode": "out", "bounce": false }
      },
      "interactivity": {
        "detect_on": "canvas",
        "events": { "onhover": { "enable": true, "mode": "repulse" }, "onclick": { "enable": false }, "resize": true },
        "modes": { "repulse": { "distance": 90, "duration": 0.35 } }
      },
      "retina_detect": true
    });
  </script>

  <script src="./extractor.js"></script>
</body>

</html>