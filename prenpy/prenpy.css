:root{
  --bg:#0b0f14; --panel:#0f1620; --line:#1f2a3a; --text:#e8eef9; --muted:#9fb0c6;
  --accent:#7c5cff; --good:#1fda8a; --warn:#ffb020; --bad:#ff4d4d; --chip:#111a26;
  --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--text);font:14px/1.35 var(--sans)}
button,input,select,textarea{font:inherit;color:inherit}
textarea{resize:none}

.topbar{
  display:grid;
  grid-template-columns:auto auto 1fr auto;
  gap:12px;
  align-items:center;
  padding:10px 12px;
  border-bottom:1px solid var(--line);
  background:linear-gradient(180deg,#0f1620,#0c131c);
}
.brand{display:flex;align-items:center;gap:10px;padding:8px 10px;border:1px solid var(--line);border-radius:12px;background:var(--chip)}
.brand .title{font-weight:800;letter-spacing:.2px;white-space:nowrap}

.actions{display:flex;gap:10px;align-items:center}

.search{display:flex;gap:10px;align-items:center;min-width:320px}
.search input{
  flex:1;
  border:1px solid var(--line);
  background:var(--chip);
  border-radius:12px;
  padding:10px 12px;
  outline:none;
}
.search input:focus{border-color:rgba(124,92,255,.55);box-shadow:0 0 0 4px rgba(124,92,255,.14)}
.search select{
  border:1px solid var(--line);
  background:var(--chip);
  border-radius:12px;
  padding:10px 10px;
  outline:none;
}

.jobbar{display:flex;align-items:center;gap:10px;min-width:460px}
.jobbar select{
  border:1px solid var(--line);
  background:var(--chip);
  border-radius:12px;
  padding:10px 10px;
  outline:none;
}
.jobText{color:var(--muted);font:12px var(--mono);min-width:140px;max-width:320px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.meter{flex:1;height:10px;border-radius:999px;border:1px solid var(--line);background:rgba(0,0,0,.15);overflow:hidden}
.meterFill{height:100%;width:0%;background:linear-gradient(90deg,var(--accent),rgba(124,92,255,.35))}

.btn{
  border:1px solid var(--line);
  background:var(--chip);
  padding:9px 10px;
  border-radius:12px;
  cursor:pointer;
  user-select:none;
}
.btn:disabled{opacity:.5;cursor:not-allowed}
.btn.primary{background:rgba(124,92,255,.18);border-color:rgba(124,92,255,.35)}
.btn.good{background:rgba(31,218,138,.14);border-color:rgba(31,218,138,.35)}
.btn.warn{background:rgba(255,176,32,.14);border-color:rgba(255,176,32,.35)}
.btn.bad{background:rgba(255,77,77,.12);border-color:rgba(255,77,77,.32)}

.layout{height:calc(100% - 56px);display:grid;grid-template-columns:340px 1fr}
.left{border-right:1px solid var(--line);background:linear-gradient(180deg,#0c131c,#0f1620);display:grid;grid-template-rows:auto 1fr}
.leftHeader{display:grid;grid-template-columns:1fr auto;gap:10px;align-items:center;padding:12px}
.projectWrap{display:grid;gap:6px;min-width:0}
.project{min-width:0;padding:10px 12px;border:1px solid var(--line);border-radius:12px;background:var(--chip);color:var(--muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.projectBadge{color:var(--muted);font:11px var(--mono);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;opacity:.9}
.fileList{padding:0 12px 12px;overflow:auto}
.fileRow{
  display:grid;
  grid-template-columns:1fr 64px;
  gap:10px;
  align-items:center;
  padding:10px 12px;
  border:1px solid var(--line);
  border-radius:12px;
  background:rgba(0,0,0,.08);
  margin-bottom:10px;
  cursor:pointer;
}
.fileRow[data-active="true"]{outline:2px solid rgba(124,92,255,.35);background:rgba(124,92,255,.08)}
.fileRow .name{min-width:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.fileRow .pct{justify-self:end;color:var(--muted);font:12px var(--mono)}

.main{display:grid;grid-template-rows:auto 1fr auto;min-width:0}
.gridHeader{
  display:grid;
  grid-template-columns:56px 1.2fr 1fr 1fr 56px;
  border-bottom:1px solid var(--line);
  background:linear-gradient(180deg,#0c131c,#0f1620);
}
.gridHeader .h{padding:10px 10px;color:var(--muted);font-weight:800}
.gridHeader .h.idx{text-align:center}
.gridHeader .h.flag{text-align:center}

.grid{
  position:relative;
  overflow:auto;
  border-bottom:1px solid var(--line);
  outline:none;
}
.gridSpacer{width:1px;opacity:0}
.gridWindow{position:absolute;left:0;top:0;right:0}

.row{
  display:grid;
  grid-template-columns:56px 1.2fr 1fr 1fr 56px;
  border-bottom:1px solid var(--line);
  min-width:0;
  height:92px;
}
.row[data-selected="true"]{background:rgba(124,92,255,.08)}
.cell{padding:10px 10px;min-width:0}
.idx{font:12px var(--mono);color:var(--muted);text-align:center}
.snip{
  height:72px;
  overflow:hidden;
  white-space:pre-wrap;
  word-break:break-word;
}
.flagBtn{
  width:28px;height:28px;border-radius:10px;border:1px solid var(--line);
  background:var(--chip);cursor:pointer;display:inline-flex;align-items:center;justify-content:center
}
.flagBtn[data-flag="done"]{border-color:rgba(31,218,138,.5);background:rgba(31,218,138,.12)}
.flagBtn[data-flag="review"]{border-color:rgba(255,176,32,.5);background:rgba(255,176,32,.12)}

.editor{padding:12px;display:grid;gap:10px;background:linear-gradient(180deg,#0c131c,#0f1620)}
.editorHeader{display:flex;justify-content:space-between;align-items:center;gap:10px}
.meta{display:flex;gap:8px;align-items:center;min-width:0}
.chip{padding:6px 10px;border-radius:999px;border:1px solid var(--line);background:var(--chip);color:var(--muted);font:12px var(--mono);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:320px}
.editorActions{display:flex;gap:10px;flex-wrap:wrap;justify-content:flex-end}
.editorBody{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px}
.col{display:grid;gap:6px;min-width:0}
.col label{color:var(--muted);font-size:12px}
.col textarea{
  border:1px solid var(--line);
  background:var(--panel);
  border-radius:12px;
  padding:10px 12px;
  height:140px;
  outline:none;
  font-family:var(--mono);
  line-height:1.35;
}
.col textarea:focus{border-color:rgba(124,92,255,.55);box-shadow:0 0 0 4px rgba(124,92,255,.14)}

.modal{position:fixed;inset:0;background:rgba(0,0,0,.55);display:flex;align-items:center;justify-content:center;padding:18px}
.hidden{display:none}
.modalCard{width:min(820px,96vw);border:1px solid var(--line);border-radius:18px;background:var(--panel);overflow:hidden}
.modalHead{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;border-bottom:1px solid var(--line)}
.modalTitle{font-weight:900}
.modalBody{padding:14px;display:grid;gap:10px}
.modalFoot{padding:12px 14px;border-top:1px solid var(--line);display:flex;justify-content:flex-end}
.field{display:grid;gap:6px}
.field label{color:var(--muted);font-size:12px}
.field input,.field select,.field textarea{
  border:1px solid var(--line);
  background:var(--chip);
  border-radius:12px;
  padding:10px 12px;
  outline:none;
}
.field input:focus,.field select:focus,.field textarea:focus{border-color:rgba(124,92,255,.55);box-shadow:0 0 0 4px rgba(124,92,255,.14)}
.row2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.hint{color:var(--muted);font-size:12px}
.mono{font-family:var(--mono)}

@media (max-width: 1200px){
  .topbar{grid-template-columns:1fr}
  .actions,.search,.jobbar{justify-self:stretch}
  .layout{grid-template-columns:1fr}
  .left{display:none}
  .editorBody{grid-template-columns:1fr}
}
